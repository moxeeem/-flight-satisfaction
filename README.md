# ✈️ Прогнозирование удовлетворенности пассажиров авиакомпании
[![plane.jpg](https://s8d6.turboimg.net/sp/819c460c696bc632fbbc27f5cf97e2b0/plane.jpg)](https://www.turboimagehost.com/p/90341179/plane.jpg.html)

## Описание
Попробуйте приложение [здесь](https://flight-satisfaction.streamlit.app/)!

В данном проекте решается задача прогноза удовлетворенности клиентов полетом.

Для достижения этой цели были выполнены следующие шаги:

- Проведен разведочный анализ данных.
- Построена ML-модель.
- Осуществлена интерпретация прогноза.
- Создан веб-сервис, позволяющий использовать проведенный анализ и применять полученную модель.

Таким образом, в проекте были применены методы анализа данных и машинного обучения для решения задачи прогнозирования удовлетворенности клиентов полетами. Созданный веб-сервис позволяет использовать полученные результаты в более широком контексте.

<p align="center">
  <img width="50%" src="https://i.pinimg.com/originals/25/86/f2/2586f298789f024eda435a479bf21d31.png">
</p>


## Файлы

- `app.py`: streamlit приложение
- `clients.csv`: обработанный датасет
- `requirements.txt`: requirements файл
- `AirflightSatisfaction.ipynb`: jupyter-ноутбук с разведочным анализом данным и моделью линейной регрессии


## Цель проекта

На основе данных опроса об удовлетворенности полетом определить критические факторы, которые приводят к удовлетворенности клиентов.


## Описание данных

Исходные данные были предоставлены на буткемпе [**Разработка ML сервиса: от идеи к прототипу**](https://stepik.org/course/176820).
Датасет содержит информацию о клиентах некоторой авиакомпании.

**Целевая переменная**
- `satisfaction`: удовлетворенность клиента полетом, бинарная (satisfied или neutral or dissatisfied)

**Признаки**
- `Gender` (categorical: _Male_ или _Female_): пол клиента
- `Age` (numeric, int): количество полных лет
- `Customer Type` (categorical: _Loyal Customer_ или _disloyal Customer_): лоялен ли клиент авиакомпании?
- `Type of Travel` (categorical: _Business travel_ или _Personal Travel_): тип поездки
- `Class` (categorical: _Business_ или _Eco_, или _Eco Plus_): класс обслуживания в самолете
- `Flight Distance` (numeric, int): дальность перелета (в милях)
- `Departure Delay in Minutes` (numeric, int): задержка отправления (неотрицательная)
- `Arrival Delay in Minutes` (numeric, int): задержка прибытия (неотрицательная)

Признаки, перечисленные ниже, являются числовыми. По смыслу они категориальные: клиент ставил оценку от 1-го до 5-ти включительно. Есть выбросы!

- `Inflight wifi service` (categorical, int): оценка клиентом интернета на борту
- `Departure/Arrival time convenient` (categorical, int): оценка клиентом удобство времени прилета и вылета
- `Ease of Online booking` (categorical, int): оценка клиентом удобства онлайн-бронирования
- `Gate location` (categorical, int): оценка клиентом расположения выхода на посадку в аэропорту
- `Food and drink` (categorical, int): оценка клиентом еды и напитков на борту
- `Online boarding` (categorical, int): оценка клиентом выбора места в самолете
- `Seat comfort` (categorical, int): оценка клиентом удобства сиденья
- `Inflight entertainment` (categorical, int): оценка клиентом развлечений на борту
- `On-board service` (categorical, int): оценка клиентом обслуживания на борту
- `Leg room service` (categorical, int): оценка клиентом места в ногах на борту
- `Baggage handling` (categorical, int): оценка клиентом обращения с багажом
- `Checkin service` (categorical, int): оценка клиентом регистрации на рейс
- `Inflight service` (categorical, int): оценка клиентом обслуживания на борту
- `Cleanliness` (categorical, int): оценка клиентом чистоты на борту

## Обзор анализа данных

В рамках проекта был проведен разведочный анализ данных. Для улучшения качества данных были удалены записи с пропущенными значениями и некорректными данными (например, некорректный возраст).

Для дальнейшего анализа было обнаружено, что данные достаточно хорошо сбалансированы относительно целевой переменной. 

Было выявлено, что удовлетворенность клиента сильно зависит от класса обслуживания, типа полета и лояльности клиента компании.

Для улучшения качества предсказаний модели были удалены признаки, которые не способствуют различению целевых классов, например, пол.

Для применения классических моделей машинного обучения категориальные признаки были преобразованы в числовые значения. Кроме того, данные были стандартизованы с помощью метода `StandardScaler()`.

## Описание ML-модели

В проекте использовалась модель логистической регрессии `LogisticRegression` на основе сетки `GridSearchCV`.

Были подобраны следующие гиперпараметры модели:


| Параметр        | Значение  |
| :-------------: |:---------:|
| C               | 0.01      |
| max_iter        | 100       |
| penalty         | l2      |
| random_state    | 0         | 

## Результаты

В нашей задаче нам интересно найти как можно больше пассажиров, которым полет не понравился или они отнеслись к нему нейтрально (класс 0), чтобы авиакомпания смогла внести изменения в свою работу.

|  Метрика  |  Значение  |
|  :-------------:  | :---------: |
| accuracy | 0.90074423930156 |
| recall  | 0.9192875381453571 | 
| f1-score | 0.9141070101560566 |

Высокие значения данных метрик показывает, что алгоритм хорошо обнаруживает объекты класса 0 и при этом уменьшает количество ложно-положительных предсказаний.

## Веб-сервис
Одной из главных задач проекта было создание веб-приложения, которое позволило бы пользователям подсчитывать вероятность удовлетворения полетом при заданных параметрах. Для этого был выбран фреймворк Streamlit, который позволяет легко создавать интерактивные веб-приложения на языке Python.


## Автор

Проект выполнен в рамках буткемпа [**Разработка ML сервиса: от идеи к прототипу**](https://stepik.org/course/176820).

Автор: Максим Иванов.

[![Telegram Status](https://img.shields.io/badge/Telegram-blue)](https://t.me/fwznn_ql1d_8)
